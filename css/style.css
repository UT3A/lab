:root {
  --bg: #0b0b0b;
  --ink: #2d3a48;
  --gold: #9c7945;
  --gold-2: #c2a572;
  --text: #f5f2e8;
  --muted: #a39a8f;
  --paper: #141414;
  --card: #121212;
  --shadow: rgba(0,0,0,.45);
  --radius: 18px;
  --radius-lg: 28px;
  --maxw: 1200px;
}

.theme-light {
  --bg: #f8f7f4;
  --ink: #3a4754;
  --gold: #8a6a3f;
  --gold-2: #b89567;
  --text: #1a1a1a;
  --muted: #4a4a4a;
  --paper: #ffffff;
  --card: #ffffff;
  --shadow: rgba(0,0,0,.12);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: 'Noto Sans TC', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans TC', "PingFang TC", "Heiti TC", sans-serif;
  color: var(--text);
  background: radial-gradient( 1200px 600px at 80% -10%, rgba(156,121,69,.14), transparent 60%), var(--bg);
  line-height: 1.6;
  overflow-x: hidden;
}

/* background layers */
.hero-canvas { position: fixed; inset: 0; z-index: -2; }
.grain { position: fixed; inset: -10%; z-index: -1; pointer-events: none; opacity:.07; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency=".85" numOctaves="2"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>'); animation: grain 12s steps(10) infinite; mix-blend-mode: overlay; }
@keyframes grain { 0%{transform:translate(0,0)} 100%{transform:translate(-10%, -10%)} }

/* nav */
header.nav {
  position: sticky; top: 0; z-index: 50;
  backdrop-filter: blur(10px);
  background: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.10));
  border-bottom: 1px solid rgba(255,255,255,.06);
}
.nav-inner { max-width: var(--maxw); margin: 0 auto; display: flex; align-items: center; gap: 16px; padding: 14px 20px; }
.brand { display: flex; align-items: center; /*gap: 12px;*/ text-decoration: none; color: var(--text);width:40% ; }
/*.brand .logo { width: 36px; height: 36px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, var(--gold-2), var(--gold)); box-shadow: inset 0 0 0 1px rgba(255,255,255,.06), 0 6px 20px var(--shadow); }*/
.brand .logo {width: 20%;}
.brand .name { font-family: 'Noto Serif TC', serif; font-weight: 900; letter-spacing:.5px; }
nav.menu { margin-left: auto; display:flex; gap: 8px; flex-wrap: wrap; }
nav.menu a { color: var(--text); text-decoration: none; padding: 10px 14px; border-radius: 999px; opacity:.9; transition: .25s ease; }
nav.menu a:hover, nav.menu a.active { background: rgba(156,121,69,.14); box-shadow: inset 0 0 0 1px rgba(156,121,69,.4); }
.theme-toggle { border: 1px solid rgba(255,255,255,.1); background: transparent; color: var(--text); border-radius: 999px; padding: 8px 12px; cursor: pointer; }

/* hero */
.hero { position: relative; display:grid; min-height: 82vh; place-items:center; text-align:center; padding: 100px 20px 60px; isolation:isolate; }
.hero .title { font-family: 'Noto Serif TC', serif; font-size: clamp(32px, 6vw, 72px); line-height: 1.08; letter-spacing: .5px; margin: 0 0 12px; text-shadow: 0 10px 30px var(--shadow); }
.hero .subtitle { max-width: 820px; margin: 0 auto; color: var(--muted); font-size: clamp(16px, 2vw, 20px); }
.hero .cta { display:flex; gap:12px; justify-content:center; margin-top: 28px; flex-wrap: wrap; }
.btn { border: 1px solid rgba(255,255,255,.14); color: var(--text); background: linear-gradient(to bottom right, rgba(156,121,69,.24), rgba(156,121,69,.04)); padding: 12px 16px; border-radius: 14px; text-decoration: none; transition:.25s ease; display:inline-flex; align-items:center; gap:8px; }
.btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px var(--shadow), inset 0 0 0 1px rgba(156,121,69,.4); }

/* sections */
section { position: relative; padding: 102px 20px; }
.wrap { max-width: var(--maxw); margin: 0 auto; }
.sec-head { display:flex; align-items:end; justify-content:space-between; gap:20px; margin-bottom: 22px; }
.sec-title { font-family: 'Noto Serif TC', serif; font-weight: 800; font-size: clamp(24px, 3.6vw, 40px); margin:0; letter-spacing:.3px; }
.sec-sub { color: var(--muted); margin:0; }
.paper { background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0)); border: 1px solid rgba(255,255,255,.06); border-radius: var(--radius-lg); box-shadow: 0 20px 50px var(--shadow); overflow: hidden; }

/* about */
.about-grid { display:grid; grid-template-columns: 1.2fr .8fr; gap: 28px; }
.about p { margin: 0 0 12px; }
.chip { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background: rgba(156,121,69,.12); border:1px solid rgba(156,121,69,.35); margin-right: 8px; margin-bottom: 8px; font-size:14px; }
.timeline { padding: 16px; }
.timeline li { list-style: none; position: relative; padding: 12px 0 12px 28px; border-bottom: 1px dashed rgba(255,255,255,.08); }
.timeline li:last-child { border-bottom: none; }
.timeline li::before { content: ""; position: absolute; left: 8px; top: 18px; width: 8px; height: 8px; border-radius: 50%; background: linear-gradient( to bottom right, var(--gold-2), var(--gold)); box-shadow: 0 0 0 3px rgba(156,121,69,.15); }

/* members */
.filters { display:flex; flex-wrap:wrap; gap: 8px; margin: 12px 0 20px; }
.filter-btn { background: transparent; color: var(--text); border: 1px solid rgba(255,255,255,.14); padding: 8px 12px; border-radius: 999px; cursor: pointer; transition:.25s ease; }
.filter-btn.active, .filter-btn:hover { background: rgba(156,121,69,.14); box-shadow: inset 0 0 0 1px rgba(156,121,69,.4); }
.search { width: 100%; max-width: 380px; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.14); color: var(--text); padding: 10px 12px; border-radius: 12px; }

.member-grid { display:grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
.member-card { grid-column: span 3; background: var(--card); border: 1px solid rgba(255,255,255,.06); border-radius: var(--radius); overflow: hidden; position: relative; transform-style: preserve-3d; transition: transform .25s ease, box-shadow .25s ease; box-shadow: 0 12px 24px var(--shadow); }
.member-card:hover { transform: translateY(-6px) rotateX(2deg) rotateY(-2deg); box-shadow: 0 24px 60px var(--shadow); }
.member-thumb{
  aspect-ratio: 1 / 1;            /* 人像照片建議正方形，若想橫式可改回 16/10 */
  background: var(--card);
  overflow: hidden;                /* 關鍵：裁掉溢出 */
  border-bottom: 1px solid rgba(255,255,255,.06);
  display: grid;
  place-items: center;
  font-family: 'Noto Serif TC', serif;
  font-weight: 900;
  font-size: 28px;
  color: rgba(0,0,0,.65);          /* 沒圖時顯示縮寫用 */
}
.member-thumb img{
  width: 100%;
  height: 100%;
  object-fit: cover;               /* 不變形鋪滿 */
  display: block;
}

.member-body { padding: 14px; }
.role { display:inline-block; font-size: 12px; color: var(--muted); }
.tags { display:flex; flex-wrap:wrap; gap:6px; margin-top: 8px; }
.tag { font-size: 12px; padding: 4px 8px; border-radius: 999px; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.12); }
.member-card button { position:absolute; inset: 0; opacity: 0; }

/* modal */
.modal { position: fixed; inset: 0; display: grid; place-items: center; padding: 24px; background: rgba(0,0,0,.55); backdrop-filter: blur(6px); visibility:hidden; opacity:0; transition: .25s ease; z-index: 60; }
.modal.open { visibility: visible; opacity: 1; }
.modal-card{
  width: min(880px, 92vw);
  max-height: 88vh;                                  /* 限高，避免超出視窗 */
  background: var(--paper);
  border-radius: var(--radius-lg);
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 40px 90px var(--shadow);
  display: grid;
  grid-template-columns: minmax(240px,300px) 1fr;    /* ← 只留這一行 */
  overflow: hidden;                                  /* 容器裁掉多餘邊緣 */
}
.modal-left{ 
  background: linear-gradient(120deg, rgba(156,121,69,.25), rgba(156,121,69,.08));
  padding: 24px;
  overflow: hidden;                                  /* 左欄不捲動 */
}
.modal-right{
  padding: 24px;
  overflow: auto;
  scrollbar-gutter: stable both-edges;               /* 防止文字跳動（可選） */
}

.avatar { width: 100%; aspect-ratio: 1; border-radius: 14px; background: linear-gradient(135deg, var(--gold-2), var(--gold)); box-shadow: inset 0 0 0 1px rgba(255,255,255,.2);
  object-fit: cover;
  display: block;
  overflow: hidden;  
  border-radius: 14px;}
/* 大頭貼圖片：填滿容器、不變形 */
.avatar img{
  width: 100%;
  height: 100%;
  object-fit: cover;                               /* 覆蓋裁切 */
  display: block;                                  /* 消除行內空隙 */
  border-radius: 14px;
}

/* 安全網：modal 內任何圖片都不會超過容器寬 */
#memberModal img{ max-width: 100%; height: auto; }
.modal-right { padding: 24px; }
.modal-close { position:absolute; top: 12px; right: 12px; background: rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18); color: var(--text); border-radius: 12px; padding: 8px 10px; cursor:pointer; }

/* stats */
.stats { display:grid; grid-template-columns: repeat(4, 1fr); gap: 14px; }
.stat { text-align:center; padding: 24px; border-radius: var(--radius); border: 1px solid rgba(255,255,255,.06); background: radial-gradient( 400px 200px at 50% 0%, rgba(156,121,69,.15), rgba(255,255,255,0) 60% ), var(--card); }
.stat .num { font-family:'Noto Serif TC', serif; font-size: clamp(28px, 4vw, 48px); }
.stat .label { color: var(--muted); font-size: 13px; letter-spacing:.3px; }

/* gallery */
.gallery { display:grid; grid-template-columns: repeat(12, 1fr); gap: 8px; }
.gallery a { grid-column: span 3; display:block; border-radius: 12px; overflow: hidden; border:1px solid rgba(255,255,255,.06); background: #222; }
.gallery img { width: 100%; height: 100%; object-fit: cover; display: block; aspect-ratio: 4/3; filter: contrast(1.02) saturate(1.02); transition: transform .3s ease; }
.gallery a:hover img { transform: scale(1.03); }

/* contact */
.contact-grid { display:grid; grid-template-columns: 1fr 1fr; gap: 24px; }
.contact-item { padding: 16px; border-radius: var(--radius); border: 1px solid rgba(255,255,255,.06); background: var(--card); }

footer { padding: 28px 20px 56px; color: var(--muted); text-align:center; border-top: 1px solid rgba(255,255,255,.06); background: linear-gradient(0deg, rgba(156,121,69,.08), transparent 60%); }

/* reveal */
.reveal { opacity: 0; transform: translateY(18px); filter: blur(6px); transition: .7s cubic-bezier(.2,.65,.2,1); }
.reveal.on { opacity:1; transform: none; filter: none; }

/* RWD */
@media (max-width: 1100px){
  .about-grid { grid-template-columns: 1fr; }

  .modal-card{
    grid-template-columns: 1fr;
    grid-template-rows: min-content 1fr;   /* 上左欄、下右欄 */
    max-height: 92vh;
  }
  .modal-left{ max-height: 42vh; }
  .modal-right{ max-height: 50vh; overflow: auto; }
}

@media (max-width: 900px){
  .member-card { grid-column: span 4; }
  .stats { grid-template-columns: repeat(2, 1fr); }
  .contact-grid { grid-template-columns: 1fr; }
}
@media (max-width: 600px){
  .member-card { grid-column: span 6; }
  .gallery a { grid-column: span 6; }
}

/* 研究主題：縮圖 + 標題覆蓋 */
#research .area-thumb{
  position: relative;
  aspect-ratio: 16 / 9;
  overflow: hidden;
  border-bottom: 1px solid rgba(255,255,255,.06);
}
#research .area-thumb img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  filter: contrast(1.05) saturate(1.05);
}

/* 研究主題：文字區塊（在圖片下方） */
#research .area-body{ padding: 14px; }
#research .area-title{
  margin: .1rem 0 .1rem;
  font-family: 'Noto Serif TC', serif;
  font-weight: 800;
  letter-spacing: .3px;
}
#research .area-desc{ margin: 0; color: var(--muted); }
